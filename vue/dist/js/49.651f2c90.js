"use strict";(self["webpackChunkweb_vue"]=self["webpackChunkweb_vue"]||[]).push([[49],{1049:function(e,a,t){t.r(a),t.d(a,{default:function(){return Y}});var r=t(6768);const o={class:"product-detail-view"},i={class:"container py-4"},n={class:"row"},c={class:"col-md-3 d-none d-md-block"},s={class:"col-12 col-md-9"};function u(e,a,t,u,d,l){const m=(0,r.g2)("category-sidebar"),g=(0,r.g2)("product-detail-component");return(0,r.uX)(),(0,r.CE)("div",o,[(0,r.Lk)("div",i,[(0,r.Lk)("div",n,[(0,r.Lk)("div",c,[(0,r.bF)(m,{"main-category-id":u.product?.main_category_id,"sub-category-id":u.product?.sub_category_id},null,8,["main-category-id","sub-category-id"])]),(0,r.Lk)("div",s,[(0,r.bF)(g,{"product-id":t.productId},null,8,["product-id"])])])])])}var d=t(4232);const l={class:"product-detail-container"},m={key:0,class:"alert alert-danger"},g={key:1,class:"product-detail-content"},p={class:"row"},y={class:"col-md-6 mb-4"},v={class:"product-gallery"},C={class:"main-image-container"},b=["src","alt"],k={key:0,class:"text-center mt-2 no-image-text"},f={key:0,class:"thumbnails mt-3"},I=["onClick"],h=["src","alt"],_={class:"col-md-6"},E={class:"product-title"},S={class:"product-info"},L={key:0,class:"info-item"},X={class:"info-value"},w={key:1,class:"info-item"},N={class:"info-value price"},A={class:"info-item"},W={class:"info-value"},P={class:"product-description mt-4"},F={key:0},Q={key:1},T={class:"product-specifications mt-5"},K=["innerHTML"],M={key:1},x={key:2,class:"no-product-message"};function B(e,a,t,o,i,n){const c=(0,r.g2)("breadcrumb-component"),s=(0,r.g2)("loading-component"),u=(0,r.g2)("router-link");return(0,r.uX)(),(0,r.CE)("div",l,[(0,r.bF)(c,{"main-category-id":o.product?.main_category_id,"main-category-name":o.product?.main_category_name,"sub-category-id":o.product?.sub_category_id,"sub-category-name":o.product?.sub_category_name,"item-name":o.product?.name},null,8,["main-category-id","main-category-name","sub-category-id","sub-category-name","item-name"]),(0,r.bF)(s,{show:o.loading,message:"載入產品詳細資訊中..."},null,8,["show"]),o.error?((0,r.uX)(),(0,r.CE)("div",m,(0,d.v_)(o.error),1)):(0,r.Q3)("",!0),o.product?((0,r.uX)(),(0,r.CE)("div",g,[(0,r.Lk)("div",p,[(0,r.Lk)("div",y,[(0,r.Lk)("div",v,[(0,r.Lk)("div",C,[(0,r.Lk)("img",{src:o.currentImage,class:"main-image",alt:o.product.name,onError:a[0]||(a[0]=(...e)=>o.handleImageError&&o.handleImageError(...e))},null,40,b),0===o.productImages.length?((0,r.uX)(),(0,r.CE)("p",k," 暫無產品圖片 ")):(0,r.Q3)("",!0)]),o.productImages.length>1?((0,r.uX)(),(0,r.CE)("div",f,[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(o.productImages,((e,t)=>((0,r.uX)(),(0,r.CE)("div",{key:"thumb-"+t,class:(0,d.C4)(["thumbnail-item",{active:t===o.currentImageIndex}]),onClick:e=>o.selectImage(t)},[(0,r.Lk)("img",{src:e.url,alt:`${o.product.name} - 圖片 ${t+1}`,class:"thumbnail-image",onError:a[1]||(a[1]=(...e)=>o.handleThumbnailError&&o.handleThumbnailError(...e))},null,40,h)],10,I)))),128))])):(0,r.Q3)("",!0)])]),(0,r.Lk)("div",_,[(0,r.Lk)("h1",E,(0,d.v_)(o.product.name),1),(0,r.Lk)("div",S,[o.product.model?((0,r.uX)(),(0,r.CE)("div",L,[a[2]||(a[2]=(0,r.Lk)("span",{class:"info-label"},"型號:",-1)),(0,r.Lk)("span",X,(0,d.v_)(o.product.model),1)])):(0,r.Q3)("",!0),o.product.price?((0,r.uX)(),(0,r.CE)("div",w,[a[3]||(a[3]=(0,r.Lk)("span",{class:"info-label"},"價格:",-1)),(0,r.Lk)("span",N,"NT$ "+(0,d.v_)(o.formatPrice(o.product.price)),1)])):(0,r.Q3)("",!0),(0,r.Lk)("div",A,[a[4]||(a[4]=(0,r.Lk)("span",{class:"info-label"},"分類:",-1)),(0,r.Lk)("span",W,(0,d.v_)(o.product.main_category_name)+" - "+(0,d.v_)(o.product.sub_category_name),1)])]),(0,r.Lk)("div",P,[a[5]||(a[5]=(0,r.Lk)("h4",null,"產品介紹",-1)),o.product.description?((0,r.uX)(),(0,r.CE)("p",F,(0,d.v_)(o.product.description),1)):((0,r.uX)(),(0,r.CE)("p",Q,"暫無產品介紹"))])])]),(0,r.Lk)("div",T,[a[6]||(a[6]=(0,r.Lk)("h3",null,"產品規格",-1)),o.product.specifications?((0,r.uX)(),(0,r.CE)("div",{key:0,class:"specifications-content",innerHTML:o.formatSpecifications(o.product.specifications)},null,8,K)):((0,r.uX)(),(0,r.CE)("p",M,"暫無產品規格資訊"))])])):o.loading||o.error?(0,r.Q3)("",!0):((0,r.uX)(),(0,r.CE)("div",x,[a[8]||(a[8]=(0,r.Lk)("p",null,"找不到該產品資訊",-1)),(0,r.bF)(u,{to:"/",class:"btn btn-primary"},{default:(0,r.k6)((()=>a[7]||(a[7]=[(0,r.eW)("返回首頁")]))),_:1})]))])}t(8111),t(1701);var D=t(144),j=t(782),R=t(4708),V=t(5480),$=t(1524),q={name:"ProductDetailComponent",components:{LoadingComponent:R.A,BreadcrumbComponent:V.A},props:{productId:{type:[Number,String],required:!0}},setup(e){const a=(0,j.Pj)(),o=t(2942),i=(0,r.EW)((()=>a.getters["products/currentProduct"])),n=(0,r.EW)((()=>a.getters["products/loading"])),c=(0,r.EW)((()=>a.getters["products/error"])),s=(0,D.KR)(0),u=(0,r.EW)((()=>i.value&&i.value.images&&0!==i.value.images.length?i.value.images.map((e=>({id:e.id,url:e.url||$.A.getProductImage(e.id),is_main:e.is_main}))):[])),d=(0,r.EW)((()=>{if(0===u.value.length)return o;const e=u.value[s.value];return e?e.url:o})),l=async()=>{try{if(await a.dispatch("products/fetchProductDetail",e.productId),u.value.length>0){s.value=0;const e=u.value.findIndex((e=>e.is_main));-1!==e&&(s.value=e)}}catch(c){console.error("載入產品詳情失敗:",c)}},m=e=>{e>=0&&e<u.value.length&&(s.value=e)},g=e=>{console.warn("主圖載入失敗，使用預設圖片:",e.target.src),e.target.src=o},p=e=>{console.warn("縮略圖載入失敗，使用預設圖片:",e.target.src),e.target.src=o},y=e=>Number(e).toLocaleString("zh-TW"),v=e=>e?e.replace(/\n/g,"<br>"):"";return(0,r.wB)((()=>e.productId),(()=>{l()}),{immediate:!0}),(0,r.sV)((()=>{l()})),{product:i,loading:n,error:c,productImages:u,currentImageIndex:s,currentImage:d,selectImage:m,handleImageError:g,handleThumbnailError:p,formatPrice:y,formatSpecifications:v}}},H=t(1241);const z=(0,H.A)(q,[["render",B],["__scopeId","data-v-26d0c11e"]]);var G=z,J=t(4663),O={name:"ProductDetailView",components:{ProductDetailComponent:G,CategorySidebar:J.A},props:{productId:{type:[Number,String],required:!0}},setup(e){const a=(0,j.Pj)(),t=(0,r.EW)((()=>a.getters["products/currentProduct"]));return{product:t}}};const U=(0,H.A)(O,[["render",u]]);var Y=U},4663:function(e,a,t){t.d(a,{A:function(){return p}});var r=t(6768),o=t(4232);const i={class:"category-sidebar"},n={class:"category-menu"},c={key:0,class:"sub-category-menu"};function s(e,a,t,s,u,d){const l=(0,r.g2)("router-link");return(0,r.uX)(),(0,r.CE)("div",i,[a[0]||(a[0]=(0,r.Lk)("h5",{class:"sidebar-title"},"產品介紹",-1)),(0,r.Lk)("ul",n,[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(s.mainCategories,(e=>((0,r.uX)(),(0,r.CE)("li",{key:e.id,class:(0,o.C4)({active:s.isMainCategoryActive(e.id)})},[(0,r.bF)(l,{to:{name:"mainCategory",params:{mainCategoryId:e.id}},class:(0,o.C4)({"active-link":s.isMainCategoryActive(e.id)})},{default:(0,r.k6)((()=>[(0,r.eW)((0,o.v_)(e.name),1)])),_:2},1032,["to","class"]),s.shouldShowSubCategories(e.id)?((0,r.uX)(),(0,r.CE)("ul",c,[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(s.getCategorySubItems(e.id),(e=>((0,r.uX)(),(0,r.CE)("li",{key:e.id,class:(0,o.C4)({active:s.isSubCategoryActive(e.id)})},[(0,r.bF)(l,{to:{name:"subCategory",params:{subCategoryId:e.id}},class:(0,o.C4)({"active-link":s.isSubCategoryActive(e.id)})},{default:(0,r.k6)((()=>[(0,r.eW)((0,o.v_)(e.name),1)])),_:2},1032,["to","class"])],2)))),128))])):(0,r.Q3)("",!0)],2)))),128))])])}t(8111),t(116);var u=t(144),d=t(782),l={name:"CategorySidebar",props:{mainCategoryId:{type:[Number,String],default:null},subCategoryId:{type:[Number,String],default:null}},setup(e){const a=(0,d.Pj)(),t=(0,r.EW)((()=>a.getters["categories/mainCategories"])),o=(0,u.KR)({}),i=(0,u.KR)(null),n=async()=>{0===t.value.length&&await a.dispatch("categories/fetchMainCategories")},c=async()=>{try{0===t.value.length&&await n();for(const e of t.value){const t=await a.dispatch("categories/fetchSubCategories",e.id);o.value[e.id]=t}}catch(e){console.error("載入子分類失敗:",e)}},s=async()=>{if(e.subCategoryId&&!i.value)for(const r of t.value){const t=o.value[r.id]||await a.dispatch("categories/fetchSubCategories",r.id);o.value[r.id]||(o.value[r.id]=t);const n=t.find((a=>a.id.toString()===e.subCategoryId.toString()));if(n){i.value=r.id,console.log("找到子分類所屬主分類:",r.id,r.name);break}}else e.mainCategoryId&&(i.value=e.mainCategoryId)},l=e=>!!g(e)||e.toString()===(i.value||"").toString(),m=e=>o.value[e]||[],g=a=>a.toString()===(e.mainCategoryId||"").toString(),p=a=>a.toString()===(e.subCategoryId||"").toString();return(0,r.wB)([()=>e.mainCategoryId,()=>e.subCategoryId],(async()=>{if(e.mainCategoryId){if(i.value=e.mainCategoryId,!o.value[e.mainCategoryId]){const t=await a.dispatch("categories/fetchSubCategories",e.mainCategoryId);o.value[e.mainCategoryId]=t}}else e.subCategoryId?await s():i.value=null}),{immediate:!0}),(0,r.sV)((async()=>{await n(),await c(),e.subCategoryId&&await s()})),{mainCategories:t,shouldShowSubCategories:l,getCategorySubItems:m,isMainCategoryActive:g,isSubCategoryActive:p}}},m=t(1241);const g=(0,m.A)(l,[["render",s],["__scopeId","data-v-33a32ee1"]]);var p=g},5480:function(e,a,t){t.d(a,{A:function(){return y}});var r=t(6768),o=t(4232);const i={"aria-label":"breadcrumb",class:"mb-4"},n={class:"breadcrumb"},c={class:"breadcrumb-item"},s={key:1},u={key:1},d={key:2,class:"breadcrumb-item active"};function l(e,a,t,l,m,g){const p=(0,r.g2)("router-link");return(0,r.uX)(),(0,r.CE)("nav",i,[(0,r.Lk)("ol",n,[(0,r.Lk)("li",c,[(0,r.bF)(p,{to:"/"},{default:(0,r.k6)((()=>a[0]||(a[0]=[(0,r.eW)("首頁")]))),_:1})]),t.mainCategoryName?((0,r.uX)(),(0,r.CE)("li",{key:0,class:(0,o.C4)(["breadcrumb-item",{active:!t.subCategoryName&&!t.itemName}])},[(t.subCategoryName||t.itemName)&&t.mainCategoryId?((0,r.uX)(),(0,r.Wv)(p,{key:0,to:{name:"mainCategory",params:{mainCategoryId:t.mainCategoryId}}},{default:(0,r.k6)((()=>[(0,r.eW)((0,o.v_)(t.mainCategoryName),1)])),_:1},8,["to"])):((0,r.uX)(),(0,r.CE)("span",s,(0,o.v_)(t.mainCategoryName),1))],2)):(0,r.Q3)("",!0),t.subCategoryName?((0,r.uX)(),(0,r.CE)("li",{key:1,class:(0,o.C4)(["breadcrumb-item",{active:!t.itemName}])},[t.itemName&&t.subCategoryId?((0,r.uX)(),(0,r.Wv)(p,{key:0,to:{name:"subCategory",params:{subCategoryId:t.subCategoryId}}},{default:(0,r.k6)((()=>[(0,r.eW)((0,o.v_)(t.subCategoryName),1)])),_:1},8,["to"])):((0,r.uX)(),(0,r.CE)("span",u,(0,o.v_)(t.subCategoryName),1))],2)):(0,r.Q3)("",!0),t.itemName?((0,r.uX)(),(0,r.CE)("li",d,(0,o.v_)(t.itemName),1)):(0,r.Q3)("",!0)])])}var m={name:"BreadcrumbComponent",props:{mainCategoryId:{type:[Number,String],default:null},mainCategoryName:{type:String,default:""},subCategoryId:{type:[Number,String],default:null},subCategoryName:{type:String,default:""},itemName:{type:String,default:""}}},g=t(1241);const p=(0,g.A)(m,[["render",l],["__scopeId","data-v-251d43c5"]]);var y=p}}]);